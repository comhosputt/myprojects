<!DOCTYPE html>
<html lang="en">
<link rel="icon" href="1.png" type="image/png">
<script src="https://www.gstatic.com/firebasejs/4.9.0/firebase.js"></script>
<script>
  var config = {
    apiKey: "AIzaSyC15IP3kl_6Cd99HZW0xUzAm-BZ15HVrDs",
    authDomain: "add-1-bbd71.firebaseapp.com",
    databaseURL: "https://add-1-bbd71-default-rtdb.firebaseio.com",
    projectId: "add-1-bbd71",
    storageBucket: "add-1-bbd71.appspot.com",
    messagingSenderId: "G-9S5PLB8Q64"
  };
  firebase.initializeApp(config);
</script>

</head>

<body>
  <script>
  
  
  function delite(Element) {


			

			var databaseRef1 = firebase.database().ref('Diary/');
			var rowIndex = 1;


			databaseRef1.once('value', function(snapshot) {
			snapshot.forEach(function(childSnapshot) {
				var childData = childSnapshot.val();
				var childKey = childSnapshot.key;
				if (childData.name==Element){
				
				firebase.database().ref("Diary/"+childKey).remove();
				alert("Удалено!");
				window.location.reload();
				
				
				}

			rowIndex = rowIndex + 1;
			});
		});


}


  	function num(Element) {


			alert(Element);
			alert(email);

			var databaseRef1 = firebase.database().ref('Diary/');
			var rowIndex = 1;
			//alert(Element);


			databaseRef1.once('value', function(snapshot) {
			snapshot.forEach(function(childSnapshot) {
				var childData = childSnapshot.val();
				var childKey = childSnapshot.key;
				//alert(email);
				
				if (childData.name==Element && (childData.id==email) ){

				localStorage.setItem("key", childKey);
				window.location='dnevnik_update.html'
				//alert(Element);
				}

			rowIndex = rowIndex + 1;
			});
		});

}
    var databaseRef = firebase.database().ref('Diary/');
    var rowIndex = 1;
    var rowIndex1 = 1;
    var Index = 1;
    var n = "stud";
	var email;
    var name = localStorage.getItem("name");
    var databaseRef1 = firebase.database().ref('users/');
    databaseRef1.once('value', function(snapshot) {
      snapshot.forEach(function(childSnapshot) {
        var childData = childSnapshot.val();
        var childKey = childSnapshot.key;
        if (childKey == name) {
          usname = childData.username;
		  email=childData.email;
          localStorage.setItem("usname", usname);
          localStorage.setItem("uid", name);
          localStorage.setItem("vibor", "three");
        }
        rowIndex1 = rowIndex1 + 1;
      });
    });
    databaseRef.once('value', function(snapshot) {
      document.write('<head>');
      document.write('<title>Дневник</title><meta charset="utf-8">');
      document.write('<link rel="stylesheet" href="fonts/icomoon/style.css">');
      document.write('<link rel="stylesheet" href="bootstrap.min.css"> ');
      document.write('<link rel="stylesheet" href="style.css"> ');
      document.write('<link rel="icon" href="1.png" type="image/png"> ');
      document.write('</head> ');
      document.write('<body style="background-image: url(3.jpg);" ><header style="background-color:#0a2017" class="site-navbar py-3 js-site-navbar site-navbar-target" > ');
      document.write('<div class="container"> ');
      document.write('<div class="row align-items-center"> ');
      document.write('<div class="col-11 col-xl-2 site-logo"> ');
      document.write(' <h1 class="mb-0"><a href="index3.html" class="text-white h2 mb-0">Дневник</a></h1> ');
      document.write('</div> ');
      document.write('<div class="col-12 col-md-10 d-none d-xl-block"> ');
      document.write(' <nav class="site-navigation position-relative text-right" role="navigation"> ');
      document.write(' <ul class="site-menu js-clone-nav mx-auto d-none d-lg-block"> ');
      document.write(' <li><a href="termin.html" class="nav-link">Словарь терминов</a></li> ');
      document.write(' <li><a href="pravila.html" class="nav-link">Цитаты</a></li> ');
     document.write('<li class="has-children">');
            document.write('<a href="#section-about" class="nav-link">Дневник</a>');
            document.write(' <ul class="dropdown">');
			document.write('  <li><a href="donat.html" class="nav-link">Просмотреть</a></li>');
            document.write('  <li><a href="dnevnik_add.html" class="nav-link">Добавить</a></li>');
            //document.write(' <li><a href="dnevnik_update.html" class="nav-link">Изменить</a></li>');
			
			document.write('</ul>');
			document.write('</li>');
      document.write('<li><a href="poisk.html" class="nav-link">Поиск</a></li>');
      document.write('<li class="has-children">');
      document.write('<a href="#section-about" class="nav-link">' + usname + '</a>');
      document.write(' <ul class="dropdown">');
      document.write(' <li><a href="mou_raboti.html" class="nav-link">Мои работы</a></li>');
      document.write(' <li><a href="save_one.html" class="nav-link">Создать новую</a></li>');
      document.write(' <li><a href="index2.html" class="nav-link">Выйти</a></li>');
      document.write('</ul>');
      document.write('</ul>');
      document.write('</nav> ');
      document.write(' </div> ');
      document.write(' </div> ');
      document.write(' </div> ');
      document.write('</div> ');
      document.write('</header> ');
      document.write('</div>');
      document.write('</div>');
      document.write('</div>');
      document.write(' <div class="container" style="background-color:#f1f9eeж">');
      document.write(' <div class="row justify-content-center mb-5" data-aos="fade-up">');
      document.write(' <div class="col-md-7 text-center border-primary">');
      document.write(' <h2 style="color: #f1f9ee; font-size: 45px; opacity:0; "> vcx </h2>');
      document.write(' <h2 style="color: #f1f9ee; font-size: 45px; opacity:0; "> vcx </h2>');
      document.write(' <h2 style="color: #ffffff; ">Дневник</h2>');
      document.write(' </div>');
      document.write(' </div>');
      snapshot.forEach(function(childSnapshot) {
        var childData = childSnapshot.val();
        var childKey = childSnapshot.key;
		if (childData.id==email){
        document.write('<div style="background-color:#ffffff; opacity:0.9; border-radius: 20px;border-width: 5px; margin-left: auto; margin-right: auto;" class="row mb-5">');
        document.write('<div class="col-md-5 ml-auto mb-5 order-md-2" data-aos="fade-up" data-aos-delay="100">');
        document.write(' <h2 style="color: #ffffff; font-size: 0px;  opacity:0;"> vcx </h2>');
		
		document.write('<button style=" margin-left:300px;background: none!important; border: none; padding: 0!important;  font-family: arial, sans-serif; color: #f16821; text-decoration: underline; cursor: pointer;" name="Button1" value="'+childData.name+'" onclick="num(value);">ИЗМЕНИТЬ</button>');
		
		
		
		document.write('<button style=" margin-left:315px;background: none!important; border: none; padding: 0!important;  font-family: arial, sans-serif; color: #f16821; text-decoration: underline; cursor: pointer;" name="Button1" value="'+childData.name+'" onclick="delite(value);">УДАЛИТЬ</button>');
		
		
		
        document.write('<img width="200" height="300"  src="' + childData.image_id + '" alt="Image" class="img-fluid rounded">');
		
        document.write('</div>');
        document.write('<div class="col-md-6 order-md-1" data-aos="fade-up"  >');
        document.write('<div >');
		
		document.write('<input type="button" style=" margin: auto;  display: block; font-family:Arial; font-size: 33px;font-weight: 500;  background-color: transparent; border: none; color: #f16821;  text-align:center; " name="Button1" value="'+childData.name+'" onclick="num(value);">');
       // document.write('<h2 class="text-primary  onclick="num(value); "   ><center>' + childData.name + '</center></h2>');
	   
	   
        document.write('</div>');
        document.write('<p><center>' + childData.autor + '</center></p>');
        document.write('<p ><center>' + childData.opis + '</center></p>');
        document.write('<ul class="ul-check list-unstyled success">');
        document.write('<li>' + childData.stat + '</li>');
        document.write('<li>' + childData.janr + '</li>');
        document.write('<li>' + childData.ratings + '</li>');
        document.write('</ul>');
		//document.write('<button style=" margin:auto; border-radius: 10px; display: block; font-size: 20px;  background-color: #f16821; border: none; color: #f1f9ee;  text-align:center; " name="Button1" value="'+childData.name+'" onclick="delite(value);">Удалить</button>');
		
        document.write('</div>');
        document.write('</div>');
		}
        rowIndex = rowIndex + 1;
      });
    });
    document.write('</div></body>');
  </script>
</body>

</html>